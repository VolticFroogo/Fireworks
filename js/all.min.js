class Particle{constructor(a,b){this.Position=a;var c=Random(1,360),d=Random(1,100);this.Velocity={x:d*Math.sin(c*Math.PI/180),y:d*Math.cos(c*Math.PI/180)},this.Alpha=Random(100,80)/100,this.Colour=b}Update(a,b){if(this.Alpha-=Decay*a,0>=this.Alpha)return void Particles.splice(b,1);this.Position.x+=this.Velocity.x*a*VelocityAmplifier,this.Position.y+=this.Velocity.y*a*VelocityAmplifier,this.Velocity.y+=ParticleGravity*a;for(var c=0;c<a;c++)this.Velocity.x*=ParticleDrag,this.Velocity.y*=ParticleDrag}Render(a,b){var c=b.width/500;a.fillStyle="rgba("+this.Colour.Red+", "+this.Colour.Green+", "+this.Colour.Blue+", "+this.Alpha+")",a.beginPath(),a.arc(this.Position.x,this.Position.y,c,0,2*Math.PI),a.fill()}}function UpdateParticles(a){Particles.forEach(function(b,c){b.Update(a,c)})}function RenderParticles(a,b){Particles.forEach(function(c){c.Render(a,b)})}$(document).ready(function(){Render()});function Render(){requestAnimationFrame(Render);var a=new Date().getTime(),b=a-LastFrame,d=1e3>b?b:0,e=document.getElementById("canvas"),f=e.getContext("2d");e.width=window.innerWidth,e.height=window.innerHeight,UpdateLauncher(d,e),UpdateFireworks(d),UpdateParticles(d),RenderBackground(f,e),RenderParticles(f,e),RenderFireworks(f,e),RenderLauncher(f,e),LastFrame=a}function RenderBackground(a,b){a.fillStyle="rgba(0, 0, 0, 1)",a.fillRect(0,0,b.width,b.height)}var Fireworks=[],Particles=[];const VelocityAmplifier=.005,FireworkGravity=.2,ParticleGravity=.03,FireworkDrag=.9999,ParticleDrag=.999,ParticlesFromFirework=100,Decay=5e-4,Colours=[{Red:255,Green:255,Blue:255},{Red:255,Green:0,Blue:0},{Red:0,Green:255,Blue:0},{Red:0,Green:0,Blue:255},{Red:255,Green:255,Blue:0},{Red:255,Green:0,Blue:255},{Red:0,Green:255,Blue:255}],RotationSpeed=Math.PI/3e3,MinLaunchTime=200,MaxLaunchTime=500;var Rotation=0,Forwards=!0,MaxRotation=Math.PI/4,NextLaunch=new Date().getTime()+Random(MaxLaunchTime,MinLaunchTime),LauncherBase={x:0,y:0},TurretPosition={x:0,y:0},LastFrame=new Date().getTime();class Firework{constructor(a,b){this.Position=a,this.Velocity=b;var c=Random(80,100)/100;this.Velocity.x*=c,this.Velocity.y*=c,this.ExplodeTime=new Date().getTime()+Random(1e3,1500)}Update(a,b){if(this.ExplodeTime<=new Date().getTime()||50>this.Position.x||this.Position.x>canvas.width-50)return this.Explode(),void Fireworks.splice(b,1);this.Position.x+=this.Velocity.x*a*VelocityAmplifier,this.Position.y+=this.Velocity.y*a*VelocityAmplifier,this.Velocity.y+=FireworkGravity*a;for(var c=0;c<a;c++)this.Velocity.x*=FireworkDrag,this.Velocity.y*=FireworkDrag}Render(a,b){var c=b.width/100;a.fillStyle="rgba(255, 255, 255, 1)",a.beginPath(),a.arc(this.Position.x,this.Position.y,c,0,2*Math.PI),a.fill()}Explode(){for(var a=RandomColour(),b=0;b<ParticlesFromFirework;b++)Particles.push(new Particle({x:this.Position.x,y:this.Position.y},a))}}function UpdateFireworks(a){Fireworks.forEach(function(b,c){b.Update(a,c)})}function RenderFireworks(a,b){Fireworks.forEach(function(c){c.Render(a,b)})}function Random(a,b){return Math.floor(Math.random()*Math.floor(b-a))+a}function RandomColour(){var a=Random(0,Colours.length),b=Colours[a];return b}function UpdateLauncher(a,b){LauncherBase.x=b.width/2,LauncherBase.y=b.height,Forwards?Rotation+=RotationSpeed*a:Rotation-=RotationSpeed*a;var c=b.width/10;if(TurretPosition.x=LauncherBase.x-c*Math.sin(Rotation),TurretPosition.y=LauncherBase.y-c*Math.cos(Rotation),Rotation>=MaxRotation?Forwards=!1:Rotation<=-MaxRotation&&(Forwards=!0),NextLaunch<=new Date().getTime()){NextLaunch=new Date().getTime()+Random(MaxLaunchTime,MinLaunchTime);var d={x:TurretPosition.x,y:TurretPosition.y},e={x:2560*(TurretPosition.x-LauncherBase.x)/b.width,y:2560*(TurretPosition.y-LauncherBase.y)/b.width},f=new Firework(d,e);Fireworks.push(f)}}function RenderLauncher(a,b){var c=b.width/20,d=Math.round(b.width/50);a.strokeStyle="rgba(200, 200, 200, 1)",a.lineWidth=d,a.beginPath(),a.moveTo(b.width/2,b.height),a.lineTo(TurretPosition.x,TurretPosition.y),a.stroke(),a.fillStyle="rgba(255, 255, 255, 1)",a.beginPath(),a.arc(LauncherBase.x,LauncherBase.y,c,Math.PI,2*Math.PI),a.fill()}